# Подробнее про Docker
Запуск проекта выполняется с помощью docker-compose. Проект содержит следующие файлы docker-compose:

* **docker-compose.yml** - главный файл;
* **docker-compose.dev.yml** - содержит ***только изменения*** относительно главного файла, необходимые для режима разработки;
* **docker-compose.test.yml** - содержит ***только изменения*** для запуска тестов;
* **docker-compose.test.dev.yml** - содержит ***только изменения*** относительно `docker-compose.test.yml`;
* **docker-compose.prod.yml** - содержит ***только изменения*** для режима `production`;

## docker-compose.yml
Файл `docker-compose.yml` - это главный compose-файл. Любая команда `docker-compose` должна
использовать этот файл в качестве первого аргумента.
Файл содержит все сервисы проекта (кроме тестовых) и основные метаданные для каждого сервиса,
такие как `build`, `env_file`, `depends_on` и т.п.

Файл `docker-compose.yml` **не должен** содержать разделов с монтированием томов (`volume`)
и указанием портов (`ports`), особенно здесь не должно быть портов, смотрящих наружу.

## docker-compose.dev.yml
Файл `docker-compose.dev.yml` используется для запуска проекта в режиме разработки.
Здесь добавляются изменения относительно `docker-compose.yml`.
Например, здесь можно примонтировать тома для папок приложения и указать порты, смотрящие наружу,
чтобы облегчить отладку.

## docker-compose.test.yml
Файл `docker-compose.test.yml` содержит сервисы только для тестов. Этого файла достаточно,
чтобы запустить тесты.

Этот файл **не должен** содержать разделов с монтированием томов (`volume`)
и указанием портов (`ports`) из соображений безопасности.
С помощью этого файла запускаются тесты в CI (git hub actions). Несмотря на то,
что тесты запускаются в изолированном контейнере, монтировать папки приложений
при запуске в любой среде, отличной от локального компьютера - это не хорошо.

Тесты можно запустить так:
<div class="termy">

```console
$ docker-compose -f docker-compose.yml -f docker-compose.test.yml up -d --build
```

</div>

При этом не будет выполнено монтирование папок приложений в контейнеры.
Возможно, ты захочешь это сделать, чтобы ускорить отладку тестов.
Для этого используется файл `docker-compose.test.dev.yml`:
<div class="termy">

```console
$ docker-compose -f docker-compose.yml -f docker-compose.test.yml -f docker-compose.test.dev.yml build
```

</div>

## docker-compose.test.dev.yml
Файл `docker-compose.test.dev.yml` используется для запуска тестов в режиме разработки.
Здесь добавляются изменения относительно `docker-compose.test.yml`.
Например, здесь можно примонтировать тома для папок приложения и указать порты, смотрящие наружу,
чтобы облегчить написание и отладку тестов.
